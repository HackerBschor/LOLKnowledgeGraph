\copy (SELECT * FROM player) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/player.csv' WITH CSV header;

\copy (SELECT id, version, key, name, title, blurb, partype, info->>'magic' AS info_magic, info->>'attack' AS info_attack, info->>'defense' AS info_defense, info->>'difficulty' AS info_difficulty, stats->>'mpregen' AS info_mpregen, stats->>'attackdamageperlevel' AS info_attackdamageperlevel, stats->>'hpregenperlevel' AS info_hpregenperlevel, stats->>'hpperlevel' AS info_hpperlevel, stats->>'crit' AS info_crit, stats->>'mpperlevel' AS info_mpperlevel, stats->>'armorperlevel' AS info_armorperlevel, stats->>'movespeed' AS info_movespeed, stats->>'critperlevel' AS info_critperlevel, stats->>'armor' AS info_armor, stats->>'mp' AS info_mp, stats->>'attackrange' AS info_attackrange, stats->>'spellblockperlevel' AS info_spellblockperlevel, stats->>'hpregen' AS info_hpregen, stats->>'mpregenperlevel' AS info_mpregenperlevel, stats->>'attackspeedperlevel' AS info_attackspeedperlevel, stats->>'attackdamage' AS info_attackdamage, stats->>'hp' AS info_hp, stats->>'spellblock' AS info_spellblock, stats->>'attackspeed' AS info_attackspeed FROM champions) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/champions.csv' WITH CSV header;

\copy (SELECT * FROM champion_tags) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/champion_tags.csv' WITH CSV header;

\copy (SELECT id, name, plaintext, gold->>'base' AS "goldBase", gold->>'total' AS "goldTotal", gold->>'sell' AS "goldSell", gold->>'purchasable' AS purchasable FROM items) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/items.csv' WITH CSV header;

\copy (SELECT * FROM item_tags) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/item_tags.csv' WITH CSV header;

\copy (SELECT * FROM item_builds_from) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/item_builds_from.csv' WITH CSV header;

\COPY (SELECT * FROM item_builds_into) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/item_builds_to.csv' WITH CSV header;

\COPY (SELECT * FROM summoner_spells) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/summoner_spells.csv' WITH CSV header;

\COPY (SELECT DISTINCT role FROM plays_in) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/roles.csv' WITH CSV header;

\COPY (SELECT DISTINCT lane FROM plays_in) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/lanes.csv' WITH CSV header;

-- FULL:
\COPY (SELECT cmid, id, game_creation, game_duration, game_id, game_mode, game_type, game_version, platform_id, queue_id, season_id FROM challenger_matches ) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/matches.csv' WITH CSV header;
\COPY (SELECT cmid, platform_id, account_id, participant_id, team_id, champion_id, spell1_id, spell2_id, role, lane, stats->>'assists' AS "statsAssists", stats->>'champLevel' AS "statsChamplevel", stats->>'combatPlayerScore' AS "statsCombatplayerscore", stats->>'damageDealtToObjectives' AS "statsDamagedealttoobjectives", stats->>'damageDealtToTurrets' AS "statsDamagedealttoturrets", stats->>'damageSelfMitigated' AS "statsDamageselfmitigated", stats->>'deaths' AS "statsDeaths", stats->>'doubleKills' AS "statsDoublekills", CAST(stats->>'firstBloodAssist' AS bool) AS "statsFirstbloodassist", CAST(stats->>'firstBloodKill' AS bool) AS "statsFirstbloodkill", CAST(stats->>'firstInhibitorAssist' AS bool) AS "statsFirstinhibitorassist", CAST(stats->>'firstInhibitorKill' AS bool) AS "statsFirstinhibitorkill", stats->>'firstTowerAssist' AS "statsFirsttowerassist", CAST(stats->>'firstTowerKill' AS bool) AS "statsFirsttowerkill", stats->>'goldEarned' AS "statsGoldearned", stats->>'goldSpent' AS "statsGoldspent", stats->>'inhibitorKills' AS "statsInhibitorkills", stats->>'item0' AS "statsItem0", stats->>'item1' AS "statsItem1", stats->>'item2' AS "statsItem2", stats->>'item3' AS "statsItem3", stats->>'item4' AS "statsItem4", stats->>'item5' AS "statsItem5", stats->>'item6' AS "statsItem6", stats->>'killingSprees' AS "statsKillingsprees", stats->>'kills' AS "statsKills", stats->>'largestCriticalStrike' AS "statsLargestcriticalstrike", stats->>'largestKillingSpree' AS "statsLargestkillingspree", stats->>'largestMultiKill' AS "statsLargestmultikill", stats->>'longestTimeSpentLiving' AS "statsLongesttimespentliving", stats->>'magicDamageDealt' AS "statsMagicdamagedealt", stats->>'magicDamageDealtToChampions' AS "statsMagicdamagedealttochampions", stats->>'magicalDamageTaken' AS "statsMagicaldamagetaken", stats->>'neutralMinionsKilled' AS "statsNeutralminionskilled", stats->>'neutralMinionsKilledEnemyJungle' AS "statsNeutralminionskilledenemyjungle", stats->>'neutralMinionsKilledTeamJungle' AS "statsNeutralminionskilledteamjungle", stats->>'objectivePlayerScore' AS "statsObjectiveplayerscore", stats->>'participantId' AS "statsParticipantid", stats->>'pentaKills' AS "statsPentakills", stats->>'perk0' AS "statsPerk0", stats->>'perk0Var1' AS "statsPerk0var1", stats->>'perk0Var2' AS "statsPerk0var2", stats->>'perk0Var3' AS "statsPerk0var3", stats->>'perk1' AS "statsPerk1", stats->>'perk1Var1' AS "statsPerk1var1", stats->>'perk1Var2' AS "statsPerk1var2", stats->>'perk1Var3' AS "statsPerk1var3", stats->>'perk2' AS "statsPerk2", stats->>'perk2Var1' AS "statsPerk2var1", stats->>'perk2Var2' AS "statsPerk2var2", stats->>'perk2Var3' AS "statsPerk2var3", stats->>'perk3' AS "statsPerk3", stats->>'perk3Var1' AS "statsPerk3var1", stats->>'perk3Var2' AS "statsPerk3var2", stats->>'perk3Var3' AS "statsPerk3var3", stats->>'perk4' AS "statsPerk4", stats->>'perk4Var1' AS "statsPerk4var1", stats->>'perk4Var2' AS "statsPerk4var2", stats->>'perk4Var3' AS "statsPerk4var3", stats->>'perk5' AS "statsPerk5", stats->>'perk5Var1' AS "statsPerk5var1", stats->>'perk5Var2' AS "statsPerk5var2", stats->>'perk5Var3' AS "statsPerk5var3", stats->>'perkPrimaryStyle' AS "statsPerkprimarystyle", stats->>'perkSubStyle' AS "statsPerksubstyle", stats->>'physicalDamageDealt' AS "statsPhysicaldamagedealt", stats->>'physicalDamageDealtToChampions' AS "statsPhysicaldamagedealttochampions", stats->>'physicalDamageTaken' AS "statsPhysicaldamagetaken", stats->>'playerScore0' AS "statsPlayerscore0", stats->>'playerScore1' AS "statsPlayerscore1", stats->>'playerScore2' AS "statsPlayerscore2", stats->>'playerScore3' AS "statsPlayerscore3", stats->>'playerScore4' AS "statsPlayerscore4", stats->>'playerScore5' AS "statsPlayerscore5", stats->>'playerScore6' AS "statsPlayerscore6", stats->>'playerScore7' AS "statsPlayerscore7", stats->>'playerScore8' AS "statsPlayerscore8", stats->>'playerScore9' AS "statsPlayerscore9", stats->>'quadraKills' AS "statsQuadrakills", stats->>'sightWardsBoughtInGame' AS "statsSightwardsboughtingame", stats->>'statPerk0' AS "statsStatperk0", stats->>'statPerk1' AS "statsStatperk1", stats->>'statPerk2' AS "statsStatperk2", stats->>'timeCCingOthers' AS "statsTimeccingothers", stats->>'totalDamageDealt' AS "statsTotaldamagedealt", stats->>'totalDamageDealtToChampions' AS "statsTotaldamagedealttochampions", stats->>'totalDamageTaken' AS "statsTotaldamagetaken", stats->>'totalHeal' AS "statsTotalheal", stats->>'totalMinionsKilled' AS "statsTotalminionskilled", stats->>'totalPlayerScore' AS "statsTotalplayerscore", stats->>'totalScoreRank' AS "statsTotalscorerank", stats->>'totalTimeCrowdControlDealt' AS "statsTotaltimecrowdcontroldealt", stats->>'totalUnitsHealed' AS "statsTotalunitshealed", stats->>'tripleKills' AS "statsTriplekills", stats->>'trueDamageDealt' AS "statsTruedamagedealt", stats->>'trueDamageDealtToChampions' AS "statsTruedamagedealttochampions", stats->>'trueDamageTaken' AS "statsTruedamagetaken", stats->>'turretKills' AS "statsTurretkills", stats->>'unrealKills' AS "statsUnrealkills", stats->>'visionScore' AS "statsVisionscore", stats->>'visionWardsBoughtInGame' AS "statsVisionwardsboughtingame", stats->>'wardsKilled' AS "statsWardskilled", stats->>'wardsPlaced' AS "statsWardsplaced" FROM plays_in) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/plays_in.csv' WITH CSV header;
\COPY (SELECT cmid, team_id, win, CAST(info->>'firstInhibitor' AS bool) AS "infoFirstinhibitor", info->>'teamId' AS "infoTeamid", CAST(info->>'firstTower' AS bool) AS "infoFirsttower", info->>'dragonKills' AS "infoDragonkills", info->>'vilemawKills' AS "infoVilemawkills", info->>'inhibitorKills' AS "infoInhibitorkills", CAST(info->>'firstRiftHerald' AS bool) AS "infoFirstriftherald", info->>'towerKills' AS "infoTowerkills", CAST(info->>'firstBlood' AS bool) AS "infoFirstblood", CAST(info->>'firstBaron' AS bool) AS "infoFirstbaron", CAST(info->>'firstDragon' AS bool) AS "infoFirstdragon", info->>'baronKills' AS "infoBaronkills", info->>'riftHeraldKills' AS "infoRiftheraldkills", info->>'dominionVictoryScore' AS "infoDominionvictoryscore" FROM teams ORDER BY cmid, team_id) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/teams.csv' WITH CSV header;

-- Train Test:
\COPY (SELECT cmid, id, game_creation, game_duration, game_id, game_mode, game_type, game_version, platform_id, queue_id, season_id FROM challenger_matches WHERE is_train) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/matches.csv' WITH CSV header;
\COPY (SELECT cmid, team_id, win, CAST(info->>'firstInhibitor' AS bool) AS "infoFirstinhibitor", info->>'teamId' AS "infoTeamid", CAST(info->>'firstTower' AS bool) AS "infoFirsttower", info->>'dragonKills' AS "infoDragonkills", info->>'vilemawKills' AS "infoVilemawkills", info->>'inhibitorKills' AS "infoInhibitorkills", CAST(info->>'firstRiftHerald' AS bool) AS "infoFirstriftherald", info->>'towerKills' AS "infoTowerkills", CAST(info->>'firstBlood' AS bool) AS "infoFirstblood", CAST(info->>'firstBaron' AS bool) AS "infoFirstbaron", CAST(info->>'firstDragon' AS bool) AS "infoFirstdragon", info->>'baronKills' AS "infoBaronkills", info->>'riftHeraldKills' AS "infoRiftheraldkills", info->>'dominionVictoryScore' AS "infoDominionvictoryscore" FROM teams JOIN (SELECT cmid FROM challenger_matches WHERE is_train) USING (cmid)) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/teams.csv' WITH CSV header;
\COPY (SELECT cmid, platform_id, account_id, participant_id, team_id, champion_id, spell1_id, spell2_id, role, lane, stats->>'assists' AS "statsAssists", stats->>'champLevel' AS "statsChamplevel", stats->>'combatPlayerScore' AS "statsCombatplayerscore", stats->>'damageDealtToObjectives' AS "statsDamagedealttoobjectives", stats->>'damageDealtToTurrets' AS "statsDamagedealttoturrets", stats->>'damageSelfMitigated' AS "statsDamageselfmitigated", stats->>'deaths' AS "statsDeaths", stats->>'doubleKills' AS "statsDoublekills", CAST(stats->>'firstBloodAssist' AS bool) AS "statsFirstbloodassist", CAST(stats->>'firstBloodKill' AS bool) AS "statsFirstbloodkill", CAST(stats->>'firstInhibitorAssist' AS bool) AS "statsFirstinhibitorassist", CAST(stats->>'firstInhibitorKill' AS bool) AS "statsFirstinhibitorkill", stats->>'firstTowerAssist' AS "statsFirsttowerassist", CAST(stats->>'firstTowerKill' AS bool) AS "statsFirsttowerkill", stats->>'goldEarned' AS "statsGoldearned", stats->>'goldSpent' AS "statsGoldspent", stats->>'inhibitorKills' AS "statsInhibitorkills", stats->>'item0' AS "statsItem0", stats->>'item1' AS "statsItem1", stats->>'item2' AS "statsItem2", stats->>'item3' AS "statsItem3", stats->>'item4' AS "statsItem4", stats->>'item5' AS "statsItem5", stats->>'item6' AS "statsItem6", stats->>'killingSprees' AS "statsKillingsprees", stats->>'kills' AS "statsKills", stats->>'largestCriticalStrike' AS "statsLargestcriticalstrike", stats->>'largestKillingSpree' AS "statsLargestkillingspree", stats->>'largestMultiKill' AS "statsLargestmultikill", stats->>'longestTimeSpentLiving' AS "statsLongesttimespentliving", stats->>'magicDamageDealt' AS "statsMagicdamagedealt", stats->>'magicDamageDealtToChampions' AS "statsMagicdamagedealttochampions", stats->>'magicalDamageTaken' AS "statsMagicaldamagetaken", stats->>'neutralMinionsKilled' AS "statsNeutralminionskilled", stats->>'neutralMinionsKilledEnemyJungle' AS "statsNeutralminionskilledenemyjungle", stats->>'neutralMinionsKilledTeamJungle' AS "statsNeutralminionskilledteamjungle", stats->>'objectivePlayerScore' AS "statsObjectiveplayerscore", stats->>'participantId' AS "statsParticipantid", stats->>'pentaKills' AS "statsPentakills", stats->>'perk0' AS "statsPerk0", stats->>'perk0Var1' AS "statsPerk0var1", stats->>'perk0Var2' AS "statsPerk0var2", stats->>'perk0Var3' AS "statsPerk0var3", stats->>'perk1' AS "statsPerk1", stats->>'perk1Var1' AS "statsPerk1var1", stats->>'perk1Var2' AS "statsPerk1var2", stats->>'perk1Var3' AS "statsPerk1var3", stats->>'perk2' AS "statsPerk2", stats->>'perk2Var1' AS "statsPerk2var1", stats->>'perk2Var2' AS "statsPerk2var2", stats->>'perk2Var3' AS "statsPerk2var3", stats->>'perk3' AS "statsPerk3", stats->>'perk3Var1' AS "statsPerk3var1", stats->>'perk3Var2' AS "statsPerk3var2", stats->>'perk3Var3' AS "statsPerk3var3", stats->>'perk4' AS "statsPerk4", stats->>'perk4Var1' AS "statsPerk4var1", stats->>'perk4Var2' AS "statsPerk4var2", stats->>'perk4Var3' AS "statsPerk4var3", stats->>'perk5' AS "statsPerk5", stats->>'perk5Var1' AS "statsPerk5var1", stats->>'perk5Var2' AS "statsPerk5var2", stats->>'perk5Var3' AS "statsPerk5var3", stats->>'perkPrimaryStyle' AS "statsPerkprimarystyle", stats->>'perkSubStyle' AS "statsPerksubstyle", stats->>'physicalDamageDealt' AS "statsPhysicaldamagedealt", stats->>'physicalDamageDealtToChampions' AS "statsPhysicaldamagedealttochampions", stats->>'physicalDamageTaken' AS "statsPhysicaldamagetaken", stats->>'playerScore0' AS "statsPlayerscore0", stats->>'playerScore1' AS "statsPlayerscore1", stats->>'playerScore2' AS "statsPlayerscore2", stats->>'playerScore3' AS "statsPlayerscore3", stats->>'playerScore4' AS "statsPlayerscore4", stats->>'playerScore5' AS "statsPlayerscore5", stats->>'playerScore6' AS "statsPlayerscore6", stats->>'playerScore7' AS "statsPlayerscore7", stats->>'playerScore8' AS "statsPlayerscore8", stats->>'playerScore9' AS "statsPlayerscore9", stats->>'quadraKills' AS "statsQuadrakills", stats->>'sightWardsBoughtInGame' AS "statsSightwardsboughtingame", stats->>'statPerk0' AS "statsStatperk0", stats->>'statPerk1' AS "statsStatperk1", stats->>'statPerk2' AS "statsStatperk2", stats->>'timeCCingOthers' AS "statsTimeccingothers", stats->>'totalDamageDealt' AS "statsTotaldamagedealt", stats->>'totalDamageDealtToChampions' AS "statsTotaldamagedealttochampions", stats->>'totalDamageTaken' AS "statsTotaldamagetaken", stats->>'totalHeal' AS "statsTotalheal", stats->>'totalMinionsKilled' AS "statsTotalminionskilled", stats->>'totalPlayerScore' AS "statsTotalplayerscore", stats->>'totalScoreRank' AS "statsTotalscorerank", stats->>'totalTimeCrowdControlDealt' AS "statsTotaltimecrowdcontroldealt", stats->>'totalUnitsHealed' AS "statsTotalunitshealed", stats->>'tripleKills' AS "statsTriplekills", stats->>'trueDamageDealt' AS "statsTruedamagedealt", stats->>'trueDamageDealtToChampions' AS "statsTruedamagedealttochampions", stats->>'trueDamageTaken' AS "statsTruedamagetaken", stats->>'turretKills' AS "statsTurretkills", stats->>'unrealKills' AS "statsUnrealkills", stats->>'visionScore' AS "statsVisionscore", stats->>'visionWardsBoughtInGame' AS "statsVisionwardsboughtingame", stats->>'wardsKilled' AS "statsWardskilled", stats->>'wardsPlaced' AS "statsWardsplaced" FROM plays_in pi JOIN (SELECT cmid FROM challenger_matches WHERE is_train) c USING (cmid)) TO 'C:/Users/Nico/PycharmProjects/LOLKnowledgeGraph/data/processed/plays_in.csv' WITH CSV header;